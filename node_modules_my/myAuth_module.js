var passport=require("passport");
var passportLocal=require("passport-local");
var passportLocalMongoose=require("passport-local-mongoose");
module.exports={
   setupAuth:function(app,secretWord){
   
           app.use(require("express-session")({
           secret:secretWord,
           resave:false,
           saveUninitialized:false
    }));
    app.use(passport.initialize());
    app.use(passport.session());},
   AuthModule:
       {
        _passport:passport,
        _passportLocal:passportLocal,
        _passportLocalMongoose:passportLocalMongoose},
   isLoggedIn:function (req,res,next){
    if(req.isAuthenticated()){
        return next();
    }else{
        res.render("campLogin.ejs",{newWarning:"Please Login!"});}
}
}